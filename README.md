# Проектная работа "Веб-ларек"

Стек: HTML, SCSS, TS, Webpack

## Установка и запуск
Для установки и запуска проекта необходимо выполнить команды

```
npm install
npm run start
```

или

```
yarn
yarn start
```
## Сборка

```
npm run build
```

или

```
yarn build
```
# Архитектура проекта «Web-larek»

![UML-диаграмма](uml.png "UML-Диаграмма")

Архитектура проекта построена на классическом шаблоне проектирования Model-View-Presenter (MVP), который разделяет приложение на три основные компонента: **Model (модель)**, **View (представление)** и **Presenter (презентер)**. 

**Model (модель)**  это ядро приложения, которое отвечает за управление данными и их состоянием. В данном случае, это класс `AppState`, который хранит информацию о каталоге товаров, корзине покупок и деталях заказа. Модель обеспечивает единое и согласованное представление данных для всего приложения.

**View (представление)** отвечает за визуализацию данных и взаимодействие с пользователем. Оно получает данные из Модели и отображает их в удобном для пользователя виде, а также передает обратно в Модель действия пользователя, такие как выбор товара, добавление в корзину или оформление заказа.

**Presenter (презентер)** выступает в роли связующего звена между Моделью и Представлением. Он обрабатывает события и действия пользователя, полученные от Представления, и передает их в Модель для обновления данных. Кроме того, Презентер отслеживает изменения в Модели и обновляет Представление соответствующим образом. 

При запуске приложения происходит загрузка каталога товаров с сервера через API. Полученные данные помещаются в свойство `catalog` класса `AppState` (Модель), и генерируется событие `CatalogChanged='catalog:changed'`, на которое может отреагировать Представление, отрендерив каталог товаров.

Когда пользователь добавляет товар в корзину, Презентер обновляет свойство basket в классе AppState (Модель), что, в свою очередь, может вызвать обновление Представления, отражающего состояние корзины. Аналогичным образом, при оформлении заказа, данные заказа сохраняются в соответствующие свойства класса AppState.

## Типы данных и интерфейсы

#### Типы данных:

**`ProductCategoryType`** - категории товаров
    
**`PaymentMethod`** - методы оплаты

#### Интерфейсы:

**`FormDataInterface`** - объединение интерфейсов `CustomerInterface` и `OrderElementsInterface`.

**`ProductInterface`** - интерфейс для описания товара.

**`CustomerInterface`** - интерфейс для формы ввода данных покупателя.

**`OrderElementsInterface`** - интерфейс для формы ввода данных заказа.

**`OrderInterface`** - интерфейс для описания заказа.

**`BasketStateInterface`** - интерфейс для описания состояния корзины.

**`BasketInterface`** - интерфейс для представления корзины в пользовательском интерфейсе.

**`ModalInterface`** - интерфейс для данных модального окна.

**`AppStateInterface`** - интерфейс для описания состояния приложения.

**`SuccessInterface`** - интерфейс для данных модального окна об успешном заказе.

**`FormInterface`**- интерфейс для представления ошибок формы.

#### Типы запросов и ответов:

**`PlaceOrderRequest`** - тип данных для запроса на оформление заказа.

**`PlaceOrderResponse`** - тип данных для ответа от сервера после оформления заказа.

### Перечисление cобытий

События связывают различные части приложения. Они дают возможность компонентам реагировать на действия пользователя и изменения, происходящие в состоянии приложения. События обеспечивают целостность и синхронизацию, позволяя обновлять пользовательский интерфейс в соответствии с текущим состоянием системы. Список событий находится в enum (перечисление) `EventsEnum` Описание событий, применяемых при реализации данного приложения:

`CatalogChanged`: Уведомляет о том, что каталог товаров был изменен.

`CardSelected`: Уведомляет о том, что пользователь выбрал карточку товара.

`ModalClosed`: Уведомляет о закрытии модального окна.

`ModalOpened`: Уведомляет об открытии модального окна.

`BasketAppended`: Уведомляет о добавлении товара в корзину покупок.

`BasketReduced`: Уведомляет об удалении товара из корзины покупок.

`BasketCleared`: Уведомляет о полной очистке корзины покупок.

`BasketChanged`: Уведомляет об изменении содержимого корзины покупок.

`BasketOpened`: Уведомляет об открытии корзины покупок.

`OrderDetailsInfoEntered`: Уведомляет о вводе информации о заказе.

`OrderAddressChanged`: Уведомляет об изменении адреса доставки заказа.

`OrderContactInfoEntered`: Уведомляет о вводе контактной информации для заказа.

`OrderEmailChanged`: Уведомляет об изменении адреса электронной почты для заказа.

`OrderPhoneNumberChanged`: Уведомляет об изменении номера телефона для заказа.

`OrderPlaced`: Уведомляет о размещении заказа.

`OrderComplete`: Уведомляет об успешном завершении заказа.

`FormErrorsChange`: Уведомляет об изменении ошибок в форме.

## Базовый код

### Класс `DataModel<T>`

Класс `DataModel<T>` является абстрактным классом, предназначенным для создания моделей данных в приложении. Он определяет базовую структуру и поведение для моделей, обеспечивая единообразный подход к работе с данными и событиями. Этот класс содержит два основных компонента: свойство `data`, которое представляет частичные данные модели, и свойство `eventHandlers`, предоставляющее интерфейс для работы с событиями. Данные модели инициализируются при создании экземпляра класса через конструктор, который принимает соответствующие параметры. Одной из ключевых особенностей класса `Model<T>` является возможность генерировать события, уведомляющие другие части приложения об изменениях в модели. За это отвечает метод `emitChangesToHandlers`, который позволяет сообщать название события и передавать связанные с ним данные.

### Класс `Component <T>`

Класс `Component<T>` является абстрактным базовым классом для работы с DOM-элементами в приложении. Он предоставляет несколько методов для манипулирования элементами. Метод `toggleClassOnElement` позволяет переключать наличие CSS-класса у заданного DOM-элемента. Он принимает сам элемент, имя класса и параметр `force`, указывающий, нужно добавить или удалить класс. Метод `setTextContent` устанавливает текстовое содержимое для заданного DOM-элемента. Он принимает сам элемент и текстовое значение, которое нужно установить.
Метод `changeDisabledStatus` позволяет заблокировать или разблокировать заданный DOM-элемент, устанавливая соответствующее состояние. Метод `setHiddenElement` скрывает заданный DOM-элемент. Метод `setVisibleElement`, наоборот, отображает ранее скрытый DOM-элемент. Метод `setImageContent` позволяет установить изображение и альтернативный текст для элемента <img>. Он принимает сам элемент, URL источника изображения и альтернативный текст. И метод `renderContent` возвращает корневой DOM-элемент компонента. 

### Класс EventEmitter

Класс `EventEmitter` представляет собой инструмент для работы с событиями в приложении. Он позволяет регистрировать обработчики событий, генерировать события и передавать данные в обработчики.

Основные методы:

`on` - регистрирует обработчик для события

`off` - снимает регистрацию обработчика

`emit` - генерирует событие и вызывает обработчики

`onAll` - регистрирует обработчик для всех событий  

`offAll` - удаляет все зарегистрированные события и обработчики

`trigger` - возвращает функцию для генерации события.

### Класс `Api`

Класс `Api` представляет собой абстракцию для выполнения HTTP-запросов к внешнему API. Он инкапсулирует логику отправки запросов, обработки ответов и предоставляет удобный интерфейс для работы с API. Основные свойства и методы класса:

Методы:
`constructor(baseUrl, options)` - конструктор для инициализации baseUrl и options.
`handleResponse(response)` - метод для обработки ответа от сервера, возвращает Promise с данными ответа или сообщением об ошибке.
`get(url)` - выполняет GET-запрос к указанному URI, возвращает Promise с данными ответа.
`post(url, data, method)` - выполняет POST-запрос к указанному URI с переданными данными, возвращает Promise с данными ответа. Поддерживает использование других HTTP-методов.

Класс `Api` обеспечивает централизованное управление HTTP-запросами, позволяя настраивать базовый URL и опции запросов. Он предоставляет методы для выполнения GET и POST запросов, а также обработки ответов сервера. Благодаря использованию Promises, класс обеспечивает удобную работу с асинхронными операциями и обработкой ошибок.